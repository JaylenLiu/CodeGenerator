webpackJsonp([4],{"1iX6":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("JBQq"),s={name:"databaseConnTree",inject:["reload"],data:function(){return{editVisible:!1,operationType:"",connTreeData:[],editData:{id:"",connName:"",connType:1,connIp:"",connPort:"",connUsername:"",connPwd:""},rules:{connName:[{required:!0,message:"请输入连接名称",trigger:"blur"}],connIp:[{required:!0,message:"请输入IP",trigger:"blur"}],connPort:[{required:!0,message:"请输入端口",trigger:"blur"}],connUsername:[{required:!0,message:"请输入用户名",trigger:"blur"}],connPwd:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},created:function(){this.initData()},computed:{connTypeOptions:function(){return[{label:"mysql",value:1},{label:"sql server",value:2},{label:"oracle",value:3}]}},methods:{handleNodeClick:function(e){var t=this;if("table"==e.nodeType){var a={conId:e.conId,databaseName:e.databaseName,tableName:e.label};n.a.get("fields",a).then(function(e){var n=[];200===e.httpCode?n=e.data:t.$message({type:"error",message:e.message}),t.$store.dispatch("saveConData",a),t.$store.dispatch("saveFileds",n)})}},initData:function(){var e=this;n.a.get("databaseTree",{}).then(function(t){200===t.httpCode?e.connTreeData=t.data:e.$message({type:"error",message:t.message})})},append:function(){this.operationType="新增",this.editVisible=!0,this.editData={id:"",connName:"",connType:1,connIp:"",connPort:"",connUsername:"",connPwd:""}},remove:function(e,t){var a=this;this.$confirm("您确定要删除数据吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.a.del("databaseConnection",{id:t.id}).then(function(e){200===e.httpCode?(a.$message({type:"success",message:"删除成功！"}),a.initData()):a.$message({type:"error",message:e.message})})})},edit:function(e,t){var a=this;this.editVisible=!0,this.operationType="编辑",n.a.get("databaseConnection",{id:t.id}).then(function(e){200===e.httpCode?a.editData=e.data:a.$message({type:"error",message:e.message})})},cancelEvent:function(e){this.$refs[e].resetFields(),this.$refs[e].clearValidate(),this.editVisible=!1},editEvent:function(e){var t=this;this.$refs[e].validate(function(a){a&&(t.editVisible=!1,t.$refs[e].clearValidate(),n.a.put("databaseConnection",t.editData).then(function(e){200===e.httpCode?(t.$message({type:"success",message:"修改成功！"}),t.initData()):t.$message({type:"error",message:e.message})}))})},submit:function(e){var t=this;this.$refs[e].validate(function(a){a&&(t.editVisible=!1,t.$refs[e].clearValidate(),n.a.post("databaseConnection",t.editData).then(function(e){200===e.httpCode?(t.$message({type:"success",message:"新增成功！"}),t.initData()):t.$message({type:"error",message:e.message})}))})}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"handle-box"},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){e.append()}}},[e._v("新增\n        ")]),e._v(" "),a("el-tree",{staticClass:"connTree",attrs:{data:e.connTreeData,accordion:"","highlight-current":""},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[e._v(e._s(n.label))]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"con"===s.nodeType,expression:"data.nodeType === 'con'"}]},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.edit(n,s)}}},[e._v("\n                        修改\n                    ")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.remove(n,s)}}},[e._v("\n                        删除\n                    ")])],1)])}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.operationType,visible:e.editVisible,width:"500px"},on:{"update:visible":function(t){e.editVisible=t},close:function(t){e.cancelEvent("connForm")}}},[a("el-form",{ref:"connForm",attrs:{model:e.editData,"label-width":"100px",rules:e.rules,"status-icon":""}},[a("el-form-item",{attrs:{label:"连接名称",prop:"connName"}},[a("el-input",{staticClass:"handle-input mr10",model:{value:e.editData.connName,callback:function(t){e.$set(e.editData,"connName",t)},expression:"editData.connName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"连接类型",prop:"connType"}},[a("el-select",{staticClass:"handle-input mr10",attrs:{placeholder:"请选择"},model:{value:e.editData.connType,callback:function(t){e.$set(e.editData,"connType",t)},expression:"editData.connType"}},e._l(e.connTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"ip",prop:"connIp"}},[a("el-input",{staticClass:"handle-input mr10",model:{value:e.editData.connIp,callback:function(t){e.$set(e.editData,"connIp",t)},expression:"editData.connIp"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"端口",prop:"connPort"}},[a("el-input",{staticClass:"handle-input mr10",model:{value:e.editData.connPort,callback:function(t){e.$set(e.editData,"connPort",t)},expression:"editData.connPort"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户名",prop:"connUsername"}},[a("el-input",{staticClass:"handle-input mr10",model:{value:e.editData.connUsername,callback:function(t){e.$set(e.editData,"connUsername",t)},expression:"editData.connUsername"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"connPwd"}},[a("el-input",{staticClass:"handle-input mr10",attrs:{type:"password"},model:{value:e.editData.connPwd,callback:function(t){e.$set(e.editData,"connPwd",t)},expression:"editData.connPwd"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.cancelEvent("connForm")}}},[e._v("取 消")]),e._v(" "),"新增"===e.operationType?a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submit("connForm")}}},[e._v("确 定")]):a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.editEvent("connForm")}}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var o={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"table"},[t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{data:this.tableData,border:""}},[t("el-table-column",{attrs:{prop:"columnName",label:"字段名称"}}),this._v(" "),t("el-table-column",{attrs:{prop:"typeName",label:"类型"}}),this._v(" "),t("el-table-column",{attrs:{prop:"columnSize",label:"字段长度"}}),this._v(" "),t("el-table-column",{attrs:{prop:"decimalDigits",label:"小数位长度"}}),this._v(" "),t("el-table-column",{attrs:{prop:"nullable",label:"是否可以为空"}}),this._v(" "),t("el-table-column",{attrs:{prop:"remarks",label:"备注"}})],1)],1)])},staticRenderFns:[]};var r={name:"key",data:function(){return{}},created:function(){},mounted:function(){this.$refs.container.style.height="680px"},computed:{},methods:{},components:{databaseConnTree:a("VU/8")(s,i,!1,function(e){a("djRX")},"data-v-528177ef",null).exports,databaseConnTable:a("VU/8")({name:"databaseConnTable",data:function(){return{}},created:function(){},computed:{tableData:function(){return this.$store.state.databaseCon.fieldData},conData:function(){return this.$store.state.databaseCon.conData}},methods:{}},o,!1,function(e){a("EcWf")},"data-v-60217367",null).exports}},l={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("div",{staticClass:"crumbs"},[t("el-breadcrumb",{attrs:{separator:"/"}},[t("el-breadcrumb-item",[t("i",{staticClass:"el-icon-tickets"}),this._v("数据库连接管理")])],1)],1),this._v(" "),t("div",{ref:"container",staticClass:"container"},[t("div",{staticClass:"handle-box"},[t("el-row",{attrs:{gutter:64}},[t("el-col",{attrs:{span:8}},[t("databaseConnTree")],1),this._v(" "),t("el-col",{attrs:{span:16}},[t("databaseConnTable")],1)],1)],1)])])},staticRenderFns:[]};var c=a("VU/8")(r,l,!1,function(e){a("H3Cf")},"data-v-9391dfde",null);t.default=c.exports},EcWf:function(e,t){},H3Cf:function(e,t){},djRX:function(e,t){}});